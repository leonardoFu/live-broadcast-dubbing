# Media Service Environment Configuration
# Copy this file to .env and customize for your environment
# Usage: docker compose --env-file .env up -d

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================

# MediaMTX Configuration
MEDIAMTX_CONTAINER_NAME=mediamtx
MEDIAMTX_RTMP_PORT=1935
MEDIAMTX_RTSP_PORT=8554
MEDIAMTX_API_PORT=9997
MEDIAMTX_METRICS_PORT=9998
MEDIAMTX_PLAYBACK_PORT=9996
MEDIAMTX_PROTOCOLS=tcp
MEDIAMTX_LOG_LEVEL=info

# Media Service Configuration
MEDIA_SERVICE_CONTAINER_NAME=media-service
MEDIA_SERVICE_IMAGE=media-service:latest
MEDIA_SERVICE_PORT=8080
BUILD_ENV=production

# =============================================================================
# INTEGRATION ENDPOINTS
# =============================================================================

# MediaMTX URLs (internal container networking)
MEDIAMTX_RTSP_URL=rtsp://mediamtx:8554
MEDIAMTX_RTMP_URL=rtmp://mediamtx:1935
ORCHESTRATOR_URL=http://media-service:8080

# STS Service URL (REQUIRED for production)
# Example: http://sts-service:3000 (Docker network)
# Example: https://sts.example.com (external service)
STS_SERVICE_URL=

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# Logging
LOG_LEVEL=INFO
LOG_MAX_SIZE=10m
LOG_MAX_FILES=3

# Media Processing
SEGMENT_DIR=/tmp/segments
METRICS_ENABLED=true
MAX_CONCURRENT_STREAMS=10

# Circuit Breaker (STS fault tolerance)
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT=60

# =============================================================================
# RESOURCE LIMITS (Docker Compose deploy section)
# =============================================================================

# MediaMTX Resources
MEDIAMTX_CPU_LIMIT=2.0
MEDIAMTX_CPU_RESERVATION=0.5
MEDIAMTX_MEMORY_LIMIT=2G
MEDIAMTX_MEMORY_RESERVATION=512M

# Media Service Resources
MEDIA_SERVICE_CPU_LIMIT=4.0
MEDIA_SERVICE_CPU_RESERVATION=1.0
MEDIA_SERVICE_MEMORY_LIMIT=4G
MEDIA_SERVICE_MEMORY_RESERVATION=1G

# =============================================================================
# HEALTH CHECK CONFIGURATION
# =============================================================================

HEALTHCHECK_INTERVAL=10s
HEALTHCHECK_TIMEOUT=5s
HEALTHCHECK_RETRIES=3
HEALTHCHECK_START_PERIOD=10s

# =============================================================================
# NETWORKING & STORAGE
# =============================================================================

# Network Configuration
NETWORK_NAME=dubbing-network

# Volume Configuration
SEGMENTS_VOLUME_NAME=media-segments
CONFIG_DIR=./config

# =============================================================================
# DEVELOPMENT OVERRIDES
# =============================================================================
# Uncomment these for local development

# LOG_LEVEL=DEBUG
# METRICS_ENABLED=false
# MAX_CONCURRENT_STREAMS=2

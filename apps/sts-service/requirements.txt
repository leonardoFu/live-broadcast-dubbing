# Production dependencies for Full STS Service
# Install with: pip install -r requirements.txt
#
# For CUDA support, install PyTorch first:
# pip install torch torchaudio --index-url https://download.pytorch.org/whl/cu121

# Core Python packages
numpy==1.26.4  # Pin exact version to avoid backtracking
scipy==1.13.1
pyyaml==6.0.3
pydantic==2.12.5

# Audio processing
soundfile==0.12.1
pydub==0.25.1
librosa==0.10.2.post1  # For audio analysis

# PyTorch (CUDA 12.1 support)
# Note: Install from PyTorch index for CUDA support
# Pin to 2.2.x for compatibility with TTS 0.22.0 (weights_only pickle security issue)
torch==2.2.2
torchaudio==2.2.2

# ASR (Automatic Speech Recognition)
faster-whisper==1.2.1
# faster-whisper dependencies
ctranslate2==4.6.2
# tokenizers is installed as dependency of faster-whisper and transformers
# Let pip resolve the compatible version
tokenizers>=0.19,<0.20

# Translation
deepl==1.27.0

# TTS (Text-to-Speech)
TTS==0.22.0  # Coqui TTS with XTTS v2 support
elevenlabs>=0.2.0,<2.0  # ElevenLabs TTS API client
# TTS dependencies
# Pin transformers to version compatible with TTS 0.22.0 (BeamSearchScorer issue)
transformers==4.43.3
sentencepiece==0.2.1
inflect==7.5.0

# Explicitly skip sudachipy (Japanese NLP, not needed for Englishâ†’Spanish)
# This package fails to build on ARM64 and is optional for TTS

# Audio time-stretching
# Note: Uses rubberband CLI tool (installed as system package in Docker)
# No Python wrapper needed - code uses subprocess to call rubberband command

# Socket.IO server
python-socketio==5.16.0
# Socket.IO async dependencies (no [asyncio] extra needed - install manually)
python-engineio==4.13.0
aiohttp==3.13.2

# Web framework
fastapi==0.128.0
uvicorn[standard]==0.40.0
starlette==0.50.0

# Observability - Prometheus metrics
prometheus-client==0.23.1

# Observability - Structured logging
structlog==23.3.0
python-json-logger==4.0.0

# GPU monitoring
pynvml==13.0.1  # NVIDIA GPU monitoring

# Utilities
rich==14.2.0  # Pretty console output

# Required by dubbing-common and dubbing-contracts
# These are installed from local packages, but list their deps here for reference
# (actual packages are installed with: pip install -e libs/common -e libs/contracts)
